[
  {
    "id": "blog:talk-about-css-selector-priority-calculation-rules",
    "type": "blog",
    "content": "CSS优先级是一个值得思考的问题，再次之前我对CSS优先级的理解是:\n\n!important>内联样式>ID选择器>类选择器>类型选择器\n\n相信很多人对CSS优先级的理解也是这样的，但是一篇文章(CSS选择器的优先级（精讲版） (biancheng.net))上面书写了关于CSS 选择器优先级的计算规则的内容，使我开始对CSS优先级进行重新研究。\n\n根据W3C给出关于选择器特异性(specificity，国内一般称优先级)的解释，选择器分为ABC三个等级，其中A为ID选择器，B包括类选择器、属性选择器和伪类，C包括类型选择器和伪元素，当然还存在一个通用选择器，但是通用选择器一般忽略。\n\n| 等级 | 包含选择器                                   |\n| ---- | -------------------------------------------- |\n| A    | 计算选择器中 ID 选择器的数量                 |\n| B    | 计算选择器中类选择器、属性选择器和伪类的数量 |\n| C    | 计算选择器中类型选择器和伪元素的数量         |\n\n优先级的计算，从A级开始到C级结束，如果到C级是两个选择器的优先级还是相等的那么有限选择靠后的选择器。\n\n重复简单选择器\n\nCSS选择器允许重复出现简单选择器，并且简单选择器的重复出现会增加优先级。\n\n也就是说如上代码中第一个选择器重复出现了选择器，第二个选择器只出现了一个选择器，这两种写法都是正确的，并且第一个选择器的优先级大于第二个选择器，所以结果是背景颜色将呈现红色。\n\n| 选择器       | 优先级 (A, B, C) |\n| ------------ | ---------------- |\n| .class.class | (0, 2, 0)        |\n| .class       | (0, 1, 0)        |\n\n在低版本CSS中可能简单重复选择器会被忽略，如在ie8中重复id或被忽略，在ie5中重复的class或被忽略。\n拒绝IE，从我做起！\n\n特殊选择器\n\n一些伪类和其他选择器中存在一些特殊的选择器，因此单独定义了这些特殊选择器的特异性。\n选择器、、的优先级是选择器列表中最具有复杂性的选择器的优先级取代。\n选择器、的优先级是伪类本身的优先级（计为一个伪类选择器，也就是计为B），再加上选择器列表中最具复杂性的选择器的优先级。\n选择器伪类的优先级被零代替，也就是没有优先级，再优先级计算中不做数。\n通用选择符以及其他选择符在优先级中不计数。\n\n优先级计算\n\n| 选择器                                              | 优先级 (A, B, C) |\n| -------------------------------------------------- | ---------------- |\n| .class                                             | (0, 1, 0)        |\n| #Red                                               | (1, 0, 0)        |\n| .container :is(.container>#Red, .container>.class) | (1, 2, 0)        |\n| .container #Red.class:nth-child(1)                 | (1, 3, 0)        |\n| :is(.container>.class.class)                       | (0, 3, 0)        |\n| #Red:is(.container>.class)                         | (1, 2, 0)        |\n| .container div:nth-child(1)                        | (0, 2, 1)        |\n| :is(#Red.class)                                    | (1, 1, 0)        |\n| #Red.class                                         | (1, 1, 0)        |\n| #Red.class:nth-child(1)                            | (1, 2, 0)        |\n| #Red#Red                                           | (2, 0, 0)        |\n\n代码片段\n\ncodepen\n\nspecificity求和\n\n在一些其他文档中将讲A、B、C分别比作100,10,1 进行求和，是不准确的，如果按照这样做那么10个class是不是相当于一个id，显然不是。\n\n在CSS Level 1、Selectors Level 3中也有这样的描述。\n\n在主流浏览器中高等级高于低等级是即使ABC求和相同也不会优先使用后声明的CSS。\n\n造成这样的原因是权重的进制是并不是十进制，CSS 权重进制在 IE6 为 256，后来扩大到了 65536，现代浏览器则采用更大的数量。也可以理解选择器的权值不能进位，或者理解为选择器权值ABC单独计算比较。\n\n关于\n\nMDN指出“使用  是一个坏习惯，应该尽量避免”，并给出了使用 的情况：\n一定要优先考虑使用样式规则的优先级来解决问题而不是 \n只有在需要覆盖全站或外部 CSS 的特定页面中使用 \n永远不要在你的插件中使用 \n永远不要在全站范围的 CSS 代码中使用 \n\n以及替代 的方法:\n更好地利用 CSS 级联属性\n使用更具体的规则。在您选择的元素之前，增加一个或多个其他元素，使选择器变得更加具体，并获得更高的优先级。\n对于（2）的一种特殊情况，当您无其他要指定的内容时，请复制简单的选择器以增加特异性。\n\n推荐阅读优先级 - CSS（层叠样式表） | MDN (mozilla.org)，了解更多的使用意见。\n其他 CSS 优先规则\n\nCSS 优先规则1： 最近的祖先样式比其他祖先样式优先级高。\n\nCSS 优先规则2： \"直接样式\"比\"祖先样式\"优先级高。\n\nCSS 优先规则3： 优先级关系：内联样式 > ID 选择器 > 类选择器 = 属性选择器 = 伪类选择器 > 标签选择器 = 伪元素选择器。\n\nCSS 优先规则4： 计算选择符中 ID 选择器的个数（a），计算选择符中类选择器、属性选择器以及伪类选择器的个数之和（b），计算选择符中标签选择器和伪元素选择器的个数之和（c）。按 a、b、c 的顺序依次比较大小，大的则优先级高，相等则比较下一个。若最后两个的选择符中 a、b、c 都相等，则按照\"就近原则\"来判断。\n\nCSS 优先规则5： 属性后插有 !important 的属性拥有最高优先级。若同时插有 !important，则再利用规则 3、4 判断优先级。\n\n注意: 文档树中元素的接近度（Proximity of elements）对优先级没有影响。\n\n参考文献\nSelectors Level 4\n优先级 - CSS（层叠样式表） | MDN (mozilla.org)\nCSS 样式优先级 | 菜鸟教程 (runoob.com)",
    "date": "2022-05-31 19:39:00"
  }
]